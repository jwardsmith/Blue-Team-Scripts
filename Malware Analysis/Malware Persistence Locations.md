# Malware Persistence Locations

### AutoStart Location

*Also known as AutoStart Extension Points (ASEPs). By far, the most popular ASEPs on the planet are the "run" Registry keys. Excellent starting place to look for malicious activity on a system. Only a fraction of possible locations are below.*

**Executed when a user logs on:**
- NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run
- NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Runonce
- SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce
- SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\Run
- SOFTWARE\Microsoft\Windows\CurrentVersion\Run

**Executed at boot:**
- SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit

**Startup Folder (shortcut files) (does not require local admin) - Executed when a user logs on:**
- %AppData%\Roaming\Microsoft\Windows\Start Menu\Programs\Startup

### Service Creation/Replacement

*Designed to run applications in the background without user interaction. Many services are required at system boot. Services can be standalone executables or loaded as DLLs. Service configurations, as well as device driver configurations, are stored in the Registry under HKLM\SYSTEM\CurrentControlSet\Services. The keys here provide the paramters for each service, including the service name, display name, path to the service's executable image file, the start value, required privileges, dependencies, and more. Each service has a start type value configured to start at boot, by manual intervention, or on trigger events such as obtaining an IP address or hardware device connections. Start values of 0x02 (Automatic) and 0x00 (Boot start of a device driver) can provide persistence for malicious code.*

**New Service Creation:**
- Start value of 0x02 will start automatically

**Service Replacement:**
- Modify and autostart a service to load new binary

**Service Failure Recovery:**


### Service Failure Recovery

### Scheduled Tasks

### DLL Hijacking

### WMI Event Consumers

### More Advanced - Local Group Policy, MS Office Add-In, or BIOS Flashing
