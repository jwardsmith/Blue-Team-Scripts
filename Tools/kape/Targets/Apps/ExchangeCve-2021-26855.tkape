Description: Exchange Server Vulnerability *.Compiled Files
Author: Dennis Reneau
Version: 1.0
Id: e7dc72be-942c-4fef-aa45-252bf2364b1e
RecreateDirectories: true
Targets:
    -
        Name: Exchange Server Modified Compiled Files
        Category: Apps
        Path: C:\Windows\Microsoft.NET\Framework*\v*\Temporary ASP.NET Files\
        Recursive: true
        FileMask: 'Regex:*.\b[a-zA-Z0-9_-]{8}\b.compiled'
        Comment: "Highly dependent on Exchange configuration"
    -
        Name: Exchange Server Modified Compiled Files
        Category: Apps
        Path: C:\inetpub\wwwroot\aspnet_client
        Recursive: true
        FileMask: 'Regex:*.\b[a-zA-Z0-9_-]{8}\b.compiled'
        Comment: "Highly dependent on Exchange configuration"
    -
        Name: Exchange Server Modified Compiled Files
        Category: Apps
        Path: C:\inetpub\wwwroot\aspnet_client\system_web\
        Recursive: true
        FileMask: 'Regex:*.\b[a-zA-Z0-9_-]{8}\b.compiled'
        Comment: "Highly dependent on Exchange configuration"
    -
        Name: Exchange Server Modified Compiled Files
        Category: Apps
        Path: C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\
        Recursive: true
        FileMask: 'Regex:*.\b[a-zA-Z0-9_-]{8}\b.compiled'
        Comment: "Highly dependent on Exchange configuration"

# Documentation
# Microsoft Exchange CVE-2021-26855
# Identified *.compound files are modified XML files associated with malicious dll's.
# https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/
# Query for WebShell IOC's with randomized 8 character names preceding the .compiled file extension.
